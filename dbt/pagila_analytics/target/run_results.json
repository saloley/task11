{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-02-06T05:18:29.540547Z", "invocation_id": "61b6f35b-9a78-4c28-a9d0-5aaf13c9046b", "invocation_started_at": "2026-02-06T05:18:16.102111Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:24.339806Z", "completed_at": "2026-02-06T05:18:24.379638Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:24.391463Z", "completed_at": "2026-02-06T05:18:24.728509Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4082932472229004, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-06d4-0001-2ec20006612e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.stg_address", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from PAGILA_SAKILA_DW.PAGILA_RAW.address\n),\n\nrenamed as (\n    select\n        -- Primary key\n        address_id,\n        \n        -- Foreign keys\n        city_id,\n        \n        -- Address attributes\n        address,\n        address2,\n        district,\n        postal_code,\n        phone,\n        \n        -- Metadata\n        last_update as source_last_update,\n        current_timestamp() as dbt_loaded_at\n        \n    from source\n)\n\nselect * from renamed", "relation_name": "PAGILA_SAKILA_DW.STAGING.stg_address", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:24.334536Z", "completed_at": "2026-02-06T05:18:24.357318Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:24.358115Z", "completed_at": "2026-02-06T05:18:24.729846Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4101905822753906, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-06d4-0001-2ec200066132"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.stg_actor", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from PAGILA_SAKILA_DW.PAGILA_RAW.actor\n),\n\nrenamed as (\n    select\n        -- Primary key\n        actor_id,\n        \n        -- Actor attributes\n        first_name,\n        last_name,\n        first_name || ' ' || last_name as full_name,\n        \n        -- Metadata\n        last_update as source_last_update,\n        current_timestamp() as dbt_loaded_at\n        \n    from source\n)\n\nselect * from renamed", "relation_name": "PAGILA_SAKILA_DW.STAGING.stg_actor", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:24.343402Z", "completed_at": "2026-02-06T05:18:24.403421Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:24.410379Z", "completed_at": "2026-02-06T05:18:24.731765Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.4108848571777344, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-06d4-0001-2ec200066136"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.stg_category", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from PAGILA_SAKILA_DW.PAGILA_RAW.category\n),\n\nrenamed as (\n    select\n        -- Primary key\n        category_id,\n        \n        -- Category attributes\n        name as category_name,\n        \n        -- Metadata\n        last_update as source_last_update,\n        current_timestamp() as dbt_loaded_at\n        \n    from source\n)\n\nselect * from renamed", "relation_name": "PAGILA_SAKILA_DW.STAGING.stg_category", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:24.759574Z", "completed_at": "2026-02-06T05:18:24.767965Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:24.768639Z", "completed_at": "2026-02-06T05:18:25.033408Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.283954381942749, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-0615-0001-2ec2000654be"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.stg_customer", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from PAGILA_SAKILA_DW.PAGILA_RAW.customer\n),\n\nrenamed as (\n    select\n        -- Primary key\n        customer_id,\n        \n        -- Foreign keys\n        store_id,\n        address_id,\n        \n        -- Customer attributes\n        first_name,\n        last_name,\n        first_name || ' ' || last_name as full_name,\n        email,\n        \n        -- Status\n        case \n            when active = 1 then true \n            when active = 0 then false\n            else null\n        end as is_active,\n        \n        -- Dates\n        create_date,\n        \n        -- Metadata\n        last_update as source_last_update,\n        current_timestamp() as dbt_loaded_at\n        \n    from source\n)\n\nselect * from renamed", "relation_name": "PAGILA_SAKILA_DW.STAGING.stg_customer", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:24.751641Z", "completed_at": "2026-02-06T05:18:24.777288Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:24.778449Z", "completed_at": "2026-02-06T05:18:25.069934Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.32169079780578613, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-0628-0001-2ec20005ba96"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.stg_city", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from PAGILA_SAKILA_DW.PAGILA_RAW.city\n),\n\nrenamed as (\n    select\n        -- Primary key\n        city_id,\n        \n        -- Foreign keys\n        country_id,\n        \n        -- City attributes\n        city as city_name,\n        \n        -- Metadata\n        last_update as source_last_update,\n        current_timestamp() as dbt_loaded_at\n        \n    from source\n)\n\nselect * from renamed", "relation_name": "PAGILA_SAKILA_DW.STAGING.stg_city", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:24.755668Z", "completed_at": "2026-02-06T05:18:24.772161Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:24.772853Z", "completed_at": "2026-02-06T05:18:25.172477Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4235990047454834, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-0601-0001-2ec2000634c6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.stg_country", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from PAGILA_SAKILA_DW.PAGILA_RAW.country\n),\n\nrenamed as (\n    select\n        -- Primary key\n        country_id,\n        \n        -- Country attributes\n        country as country_name,\n        \n        -- Metadata\n        last_update as source_last_update,\n        current_timestamp() as dbt_loaded_at\n        \n    from source\n)\n\nselect * from renamed", "relation_name": "PAGILA_SAKILA_DW.STAGING.stg_country", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:25.075255Z", "completed_at": "2026-02-06T05:18:25.085013Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:25.085848Z", "completed_at": "2026-02-06T05:18:25.309391Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.23543119430541992, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-0615-0001-2ec2000654c2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.stg_film_actor", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from PAGILA_SAKILA_DW.PAGILA_RAW.film_actor\n),\n\nrenamed as (\n    select\n        -- Composite key\n        film_id,\n        actor_id,\n        \n        -- Metadata\n        last_update as source_last_update,\n        current_timestamp() as dbt_loaded_at\n        \n    from source\n)\n\nselect * from renamed", "relation_name": "PAGILA_SAKILA_DW.STAGING.stg_film_actor", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:25.038550Z", "completed_at": "2026-02-06T05:18:25.046456Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:25.047074Z", "completed_at": "2026-02-06T05:18:25.313415Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2761044502258301, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-06d4-0001-2ec20006613a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.stg_film", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from PAGILA_SAKILA_DW.PAGILA_RAW.film\n),\n\nrenamed as (\n    select\n        -- Primary key\n        film_id,\n        \n        -- Film attributes\n        title,\n        description,\n        release_year,\n        language_id,\n        \n        -- Rental information\n        rental_duration,\n        rental_rate::decimal(4,2) as rental_rate,\n        replacement_cost::decimal(5,2) as replacement_cost,\n        \n        -- Film characteristics\n        length as duration_minutes,\n        rating,\n        special_features,\n        \n        -- Metadata\n        last_update as source_last_update,\n        current_timestamp() as dbt_loaded_at\n        \n    from source\n)\n\nselect * from renamed", "relation_name": "PAGILA_SAKILA_DW.STAGING.stg_film", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:25.178462Z", "completed_at": "2026-02-06T05:18:25.188635Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:25.189338Z", "completed_at": "2026-02-06T05:18:25.411524Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.23473119735717773, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-06d4-0001-2ec20006613e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.stg_film_category", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from PAGILA_SAKILA_DW.PAGILA_RAW.film_category\n),\n\nrenamed as (\n    select\n        -- Composite key\n        film_id,\n        category_id,\n        \n        -- Metadata\n        last_update as source_last_update,\n        current_timestamp() as dbt_loaded_at\n        \n    from source\n)\n\nselect * from renamed", "relation_name": "PAGILA_SAKILA_DW.STAGING.stg_film_category", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:25.322697Z", "completed_at": "2026-02-06T05:18:25.334896Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:25.335544Z", "completed_at": "2026-02-06T05:18:25.658313Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3387160301208496, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-0601-0001-2ec2000634ca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.stg_inventory", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from PAGILA_SAKILA_DW.PAGILA_RAW.inventory\n),\n\nrenamed as (\n    select\n        -- Primary key\n        inventory_id,\n        \n        -- Foreign keys\n        film_id,\n        store_id,\n        \n        -- Metadata\n        last_update as source_last_update,\n        current_timestamp() as dbt_loaded_at\n        \n    from source\n)\n\nselect * from renamed", "relation_name": "PAGILA_SAKILA_DW.STAGING.stg_inventory", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:25.417570Z", "completed_at": "2026-02-06T05:18:25.427362Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:25.428000Z", "completed_at": "2026-02-06T05:18:25.751091Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3349928855895996, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-0601-0001-2ec2000634ce"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.stg_rental", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from PAGILA_SAKILA_DW.PAGILA_RAW.rental\n),\n\nrenamed as (\n    select\n        -- Primary key\n        rental_id,\n        \n        -- Foreign keys\n        inventory_id,\n        customer_id,\n        staff_id,\n        \n        -- Rental details\n        rental_date,\n        return_date,\n        \n        -- Calculated fields\n        case \n            when return_date is not null \n            then datediff('hour', rental_date, return_date)\n            else null\n        end as rental_duration_hours,\n        \n        case \n            when return_date is null \n            then true \n            else false \n        end as is_currently_rented,\n        \n        -- Metadata\n        last_update as source_last_update,\n        current_timestamp() as dbt_loaded_at\n        \n    from source\n)\n\nselect * from renamed", "relation_name": "PAGILA_SAKILA_DW.STAGING.stg_rental", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:25.328908Z", "completed_at": "2026-02-06T05:18:25.339618Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:25.340271Z", "completed_at": "2026-02-06T05:18:25.902637Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.5843064785003662, "adapter_response": {}, "message": "Database Error in model stg_payment (models/staging/stg_payment.sql)\n  002003 (42S02): SQL compilation error:\n  Object 'PAGILA_SAKILA_DW.PAGILA_RAW.PAYMENT' does not exist or not authorized.\n  compiled code at target/run/pagila_analytics/models/staging/stg_payment.sql", "failures": null, "unique_id": "model.pagila_analytics.stg_payment", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from PAGILA_SAKILA_DW.PAGILA_RAW.payment\n),\n\nrenamed as (\n    select\n        -- Primary key\n        payment_id,\n        \n        -- Foreign keys\n        customer_id,\n        staff_id,\n        rental_id,\n        \n        -- Payment details\n        amount::decimal(5,2) as payment_amount,\n        payment_date,\n        \n        -- Metadata\n        current_timestamp() as dbt_loaded_at\n        \n    from source\n)\n\nselect * from renamed", "relation_name": "PAGILA_SAKILA_DW.STAGING.stg_payment", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:25.913406Z", "completed_at": "2026-02-06T05:18:25.922721Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:25.923376Z", "completed_at": "2026-02-06T05:18:26.378051Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.46602320671081543, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-0628-0001-2ec20005baa2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.int_film_actor_bridge", "compiled": true, "compiled_code": "\n\nwith film_actor as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_film_actor\n),\n\nfilms as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_film\n),\n\nactors as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_actor\n),\n\nenriched as (\n    select\n        fa.film_id,\n        fa.actor_id,\n        \n        -- Film details\n        f.title,\n        f.rating,\n        f.rental_rate,\n        \n        -- Actor details\n        a.full_name as actor_name,\n        a.first_name,\n        a.last_name,\n        \n        -- Metadata\n        fa.dbt_loaded_at\n        \n    from film_actor fa\n    inner join films f on fa.film_id = f.film_id\n    inner join actors a on fa.actor_id = a.actor_id\n)\n\nselect * from enriched", "relation_name": "PAGILA_SAKILA_DW.INTERMEDIATE.int_film_actor_bridge", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:25.664484Z", "completed_at": "2026-02-06T05:18:25.678347Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:25.678962Z", "completed_at": "2026-02-06T05:18:26.399274Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.7362048625946045, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-0601-0001-2ec2000634d2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.int_customer_enriched", "compiled": true, "compiled_code": "\n\nwith customers as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_customer\n),\n\naddresses as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_address\n),\n\ncities as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_city\n),\n\ncountries as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_country\n),\n\ncustomer_enriched as (\n    select\n        c.customer_id,\n        c.store_id,\n        \n        -- Customer details\n        c.first_name,\n        c.last_name,\n        c.full_name,\n        c.email,\n        c.is_active,\n        c.create_date,\n        \n        -- Address details\n        a.address_id,\n        a.address,\n        a.address2,\n        a.district,\n        a.postal_code,\n        a.phone,\n        \n        -- Location details\n        ci.city_id,\n        ci.city_name,\n        co.country_id,\n        co.country_name,\n        \n        -- Full location string\n        ci.city_name || ', ' || co.country_name as full_location,\n        \n        -- Metadata\n        c.dbt_loaded_at\n        \n    from customers c\n    inner join addresses a on c.address_id = a.address_id\n    inner join cities ci on a.city_id = ci.city_id\n    inner join countries co on ci.country_id = co.country_id\n)\n\nselect * from customer_enriched", "relation_name": "PAGILA_SAKILA_DW.INTERMEDIATE.int_customer_enriched", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:24.323945Z", "completed_at": "2026-02-06T05:18:25.003484Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:25.004160Z", "completed_at": "2026-02-06T05:18:26.566103Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.247105121612549, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-0628-0001-2ec20005ba9a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.dim_date", "compiled": true, "compiled_code": "\n\nwith date_spine as (\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n     + \n    \n    p11.generated_number * power(2, 11)\n     + \n    \n    p12.generated_number * power(2, 12)\n     + \n    \n    p13.generated_number * power(2, 13)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n     cross join \n    \n    p as p11\n     cross join \n    \n    p as p12\n     cross join \n    \n    p as p13\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 9495\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    dateadd(\n        day,\n        row_number() over (order by 1) - 1,\n        cast('2005-01-01' as date)\n        )\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2030-12-31' as date)\n\n)\n\nselect * from filtered\n\n\n),\n\ndim_date as (\n    select\n        cast(date_day as date) as date_key,\n        \n        -- Date parts\n        extract(year from date_day) as year,\n        extract(quarter from date_day) as quarter,\n        extract(month from date_day) as month,\n        extract(week from date_day) as week_of_year,\n        extract(day from date_day) as day_of_month,\n        extract(dayofweek from date_day) as day_of_week,\n        extract(dayofyear from date_day) as day_of_year,\n        \n        -- Date labels\n        to_char(date_day, 'YYYY-MM-DD') as date_string,\n        to_char(date_day, 'Month') as month_name,\n        to_char(date_day, 'Mon') as month_short_name,\n        to_char(date_day, 'Day') as day_name,\n        to_char(date_day, 'Dy') as day_short_name,\n        \n        -- Fiscal periods (assuming fiscal year = calendar year)\n        concat('Q', extract(quarter from date_day), '-', extract(year from date_day)) as fiscal_quarter,\n        concat(to_char(date_day, 'Mon'), '-', extract(year from date_day)) as fiscal_month,\n        \n        -- Week labels\n        concat('W', lpad(cast(extract(week from date_day) as varchar), 2, '0'), '-', extract(year from date_day)) as week_label,\n        \n        -- Boolean flags\n        case when extract(dayofweek from date_day) in (0, 6) then true else false end as is_weekend,\n        case when extract(dayofweek from date_day) between 1 and 5 then true else false end as is_weekday,\n        \n        -- First/Last day flags\n        case when extract(day from date_day) = 1 then true else false end as is_first_day_of_month,\n        case when extract(day from date_day) = extract(day from last_day(date_day)) then true else false end as is_last_day_of_month,\n        \n        -- Metadata\n        current_timestamp() as dbt_loaded_at,\n        current_timestamp() as dbt_updated_at\n        \n    from date_spine\n)\n\nselect * from dim_date", "relation_name": "PAGILA_SAKILA_DW.MARTS.dim_date", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:26.509821Z", "completed_at": "2026-02-06T05:18:26.521637Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:26.522359Z", "completed_at": "2026-02-06T05:18:26.921669Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4133939743041992, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-0615-0001-2ec2000654c6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.film_category_distribution", "compiled": true, "compiled_code": "\n\n-- Film Category Distribution Analysis\n-- Shows the distribution of films across different categories\n\nwith film_category as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_film_category\n),\n\ncategories as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_category\n),\n\nfilms as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_film\n),\n\ncategory_distribution as (\n    select\n        c.category_name,\n        count(distinct fc.film_id) as film_count,\n        round(avg(f.rental_rate), 2) as avg_rental_rate,\n        round(avg(f.duration_minutes), 0) as avg_duration_minutes,\n        round(avg(f.replacement_cost), 2) as avg_replacement_cost,\n        \n        -- Distribution percentage\n        round(\n            count(distinct fc.film_id)::decimal / \n            sum(count(distinct fc.film_id)) over () * 100, \n            2\n        ) as percentage_of_total\n        \n    from categories c\n    left join film_category fc on c.category_id = fc.category_id\n    left join films f on fc.film_id = f.film_id\n    group by c.category_name\n    order by film_count desc\n)\n\nselect * from category_distribution", "relation_name": "PAGILA_SAKILA_DW.ANALYTICS.film_category_distribution", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:26.572109Z", "completed_at": "2026-02-06T05:18:26.581591Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:26.582147Z", "completed_at": "2026-02-06T05:18:27.097961Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5273964405059814, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-0601-0001-2ec2000634de"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.films_not_in_inventory", "compiled": true, "compiled_code": "\n\n-- Films Not In Inventory Analysis\n-- Identifies films that exist in catalog but have no inventory copies\n\nwith films as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_film\n),\n\ninventory as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_inventory\n),\n\nfilm_categories as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_film_category\n),\n\ncategories as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_category\n),\n\nfilms_without_inventory as (\n    select\n        f.film_id,\n        f.title,\n        f.description,\n        f.release_year,\n        f.rating,\n        f.rental_rate,\n        f.duration_minutes,\n        f.replacement_cost,\n        c.category_name,\n        \n        -- Potential revenue loss (assuming average rental rate)\n        f.rental_rate as potential_revenue_per_rental\n        \n    from films f\n    left join inventory i on f.film_id = i.film_id\n    left join film_categories fc on f.film_id = fc.film_id\n    left join categories c on fc.category_id = c.category_id\n    where i.inventory_id is null\n    order by f.title\n)\n\nselect * from films_without_inventory", "relation_name": "PAGILA_SAKILA_DW.ANALYTICS.films_not_in_inventory", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:25.757050Z", "completed_at": "2026-02-06T05:18:25.767364Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:25.767949Z", "completed_at": "2026-02-06T05:18:27.264745Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5091123580932617, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-0601-0001-2ec2000634d6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.dim_actor", "compiled": true, "compiled_code": "\n\nwith actors as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_actor\n),\n\nfilm_actor as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_film_actor\n),\n\nactor_stats as (\n    select\n        actor_id,\n        count(distinct film_id) as total_films\n    from film_actor\n    group by actor_id\n),\n\ndim_actor as (\n    select\n        a.actor_id,\n        a.first_name,\n        a.last_name,\n        a.full_name,\n        \n        -- Actor statistics\n        coalesce(ast.total_films, 0) as total_films,\n        \n        -- Metadata\n        a.source_last_update,\n        a.dbt_loaded_at,\n        current_timestamp() as dbt_updated_at\n        \n    from actors a\n    left join actor_stats ast on a.actor_id = ast.actor_id\n)\n\nselect * from dim_actor", "relation_name": "PAGILA_SAKILA_DW.MARTS.dim_actor", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-2 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pagila_analytics.fact_revenue", "compiled": false, "compiled_code": null, "relation_name": "PAGILA_SAKILA_DW.MARTS.fact_revenue", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-2 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pagila_analytics.int_rental_facts", "compiled": false, "compiled_code": null, "relation_name": "PAGILA_SAKILA_DW.INTERMEDIATE.int_rental_facts", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-2 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pagila_analytics.customer_distribution_by_city", "compiled": false, "compiled_code": null, "relation_name": "PAGILA_SAKILA_DW.ANALYTICS.customer_distribution_by_city", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:26.927544Z", "completed_at": "2026-02-06T05:18:26.937123Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:26.937674Z", "completed_at": "2026-02-06T05:18:27.516851Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5907621383666992, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-06d4-0001-2ec200066142"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.top_children_actors", "compiled": true, "compiled_code": "\n\n-- Top Children Film Actors Analysis\n-- Identifies the most popular actors in children's films (G and PG rated)\n\nwith rentals as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_rental\n),\n\ninventory as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_inventory\n),\n\nfilms as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_film\n),\n\nfilm_actor as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_film_actor\n),\n\nactors as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_actor\n),\n\nchildren_film_actors as (\n    select\n        a.actor_id,\n        a.full_name as actor_name,\n        a.first_name,\n        a.last_name,\n        \n        -- Rental metrics for children's films\n        count(distinct r.rental_id) as total_rentals_children_films,\n        count(distinct f.film_id) as children_films_count,\n        \n        -- Film ratings breakdown\n        count(distinct case when f.rating = 'G' then f.film_id end) as g_rated_films,\n        count(distinct case when f.rating = 'PG' then f.film_id end) as pg_rated_films,\n        \n        -- Average rental metrics\n        round(avg(f.rental_rate), 2) as avg_rental_rate,\n        round(avg(f.duration_minutes), 0) as avg_film_duration\n        \n    from actors a\n    inner join film_actor fa on a.actor_id = fa.actor_id\n    inner join films f on fa.film_id = f.film_id and f.rating in ('G', 'PG')\n    inner join inventory i on f.film_id = i.film_id\n    inner join rentals r on i.inventory_id = r.inventory_id\n    group by \n        a.actor_id,\n        a.full_name,\n        a.first_name,\n        a.last_name\n    order by total_rentals_children_films desc\n)\n\nselect * from children_film_actors", "relation_name": "PAGILA_SAKILA_DW.ANALYTICS.top_children_actors", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-3 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pagila_analytics.highest_revenue_category", "compiled": false, "compiled_code": null, "relation_name": "PAGILA_SAKILA_DW.ANALYTICS.highest_revenue_category", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-3 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pagila_analytics.category_rental_hours_analysis", "compiled": false, "compiled_code": null, "relation_name": "PAGILA_SAKILA_DW.ANALYTICS.category_rental_hours_analysis", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-3 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pagila_analytics.fact_rental", "compiled": false, "compiled_code": null, "relation_name": "PAGILA_SAKILA_DW.MARTS.fact_rental", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:26.383889Z", "completed_at": "2026-02-06T05:18:26.400871Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:26.402247Z", "completed_at": "2026-02-06T05:18:28.130076Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.747631549835205, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-0601-0001-2ec2000634da"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.dim_film", "compiled": true, "compiled_code": "\n\nwith films as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_film\n),\n\nfilm_categories as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_film_category\n),\n\ncategories as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_category\n),\n\nfilm_with_category as (\n    select\n        f.film_id,\n        f.title,\n        f.description,\n        f.release_year,\n        f.language_id,\n        f.rental_duration,\n        f.rental_rate,\n        f.duration_minutes,\n        f.replacement_cost,\n        f.rating,\n        f.special_features,\n        \n        -- Category information\n        c.category_id,\n        c.category_name,\n        \n        -- Metadata\n        f.source_last_update,\n        f.dbt_loaded_at,\n        current_timestamp() as dbt_updated_at\n        \n    from films f\n    left join film_categories fc on f.film_id = fc.film_id\n    left join categories c on fc.category_id = c.category_id\n)\n\nselect * from film_with_category", "relation_name": "PAGILA_SAKILA_DW.MARTS.dim_film", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:27.103344Z", "completed_at": "2026-02-06T05:18:27.113489Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:27.114057Z", "completed_at": "2026-02-06T05:18:27.546876Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4449152946472168, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-0615-0001-2ec2000654ca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.top_rented_actors", "compiled": true, "compiled_code": "\n\n-- Top Rented Actors Analysis\n-- Identifies the most popular actors based on rental counts\n\nwith rentals as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_rental\n),\n\ninventory as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_inventory\n),\n\nfilm_actor as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_film_actor\n),\n\nactors as (\n    select * from PAGILA_SAKILA_DW.STAGING.stg_actor\n),\n\nactor_rentals as (\n    select\n        a.actor_id,\n        a.full_name as actor_name,\n        a.first_name,\n        a.last_name,\n        count(distinct r.rental_id) as total_rentals,\n        count(distinct fa.film_id) as films_appeared_in,\n        \n        -- Revenue generated by actor's films\n        round(avg(r.rental_duration_hours), 2) as avg_rental_duration_hours\n        \n    from actors a\n    inner join film_actor fa on a.actor_id = fa.actor_id\n    inner join inventory i on fa.film_id = i.film_id\n    inner join rentals r on i.inventory_id = r.inventory_id\n    group by \n        a.actor_id,\n        a.full_name,\n        a.first_name,\n        a.last_name\n    order by total_rentals desc\n)\n\nselect * from actor_rentals", "relation_name": "PAGILA_SAKILA_DW.ANALYTICS.top_rented_actors", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-06T05:18:27.275538Z", "completed_at": "2026-02-06T05:18:27.284694Z"}, {"name": "execute", "started_at": "2026-02-06T05:18:27.285296Z", "completed_at": "2026-02-06T05:18:28.918728Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.6444439888000488, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c2397e-0005-0615-0001-2ec2000654ce"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.pagila_analytics.dim_customer", "compiled": true, "compiled_code": "\n\nwith customer_enriched as (\n    select * from PAGILA_SAKILA_DW.INTERMEDIATE.int_customer_enriched\n),\n\ndim_customer as (\n    select\n        customer_id,\n        store_id,\n        \n        -- Customer information\n        first_name,\n        last_name,\n        full_name,\n        email,\n        is_active,\n        create_date,\n        \n        -- Address information\n        address_id,\n        address,\n        address2,\n        district,\n        postal_code,\n        phone,\n        \n        -- Location information\n        city_id,\n        city_name,\n        country_id,\n        country_name,\n        full_location,\n        \n        -- Metadata\n        dbt_loaded_at,\n        current_timestamp() as dbt_updated_at\n        \n    from customer_enriched\n)\n\nselect * from dim_customer", "relation_name": "PAGILA_SAKILA_DW.MARTS.dim_customer", "batch_results": null}], "elapsed_time": 7.047137260437012, "args": {"strict_mode": false, "show_all_deprecations": false, "invocation_command": "dbt run", "log_format": "default", "partial_parse": true, "send_anonymous_usage_stats": true, "select": [], "log_level": "info", "which": "run", "version_check": true, "cache_selected_only": false, "static_parser": true, "vars": {}, "use_colors_file": true, "log_level_file": "debug", "introspect": true, "log_path": "/opt/airflow/dbt/pagila_analytics/logs", "favor_state": false, "log_format_file": "debug", "require_ref_searches_node_package_before_root": false, "require_resource_names_without_spaces": true, "populate_cache": true, "require_explicit_package_overrides_for_builtin_materializations": true, "profiles_dir": "/opt/airflow/dbt/pagila_analytics", "require_nested_cumulative_type_params": false, "defer": false, "source_freshness_run_project_hooks": true, "upload_to_artifacts_ingest_api": false, "partial_parse_file_diff": true, "require_unique_project_resource_names": false, "require_batched_execution_for_custom_microbatch_strategy": false, "write_json": true, "require_yaml_configuration_for_mf_time_spines": false, "macro_debugging": false, "project_dir": "/opt/airflow/dbt/pagila_analytics", "log_file_max_bytes": 10485760, "indirect_selection": "eager", "empty": false, "validate_macro_args": false, "state_modified_compare_more_unrendered_values": false, "require_generic_test_arguments_property": true, "skip_nodes_if_on_run_start_fails": false, "require_all_warnings_handled_by_warn_error": false, "state_modified_compare_vars": false, "show_resource_report": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "printer_width": 80, "exclude": [], "quiet": false, "use_colors": true, "print": true, "use_fast_test_edges": false}}